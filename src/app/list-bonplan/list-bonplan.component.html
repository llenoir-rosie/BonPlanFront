<!DOCTYPE html>
  <html>                        
    <head>                        
      <title>BonPlan</title>                        
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">    
      <link href='https://css.gg/css' rel='stylesheet'>                  
    </head> 
    <body>       
      <div *ngIf="this.listNameActivities.includes(this.nomdelactivite) && this.listNameVille.includes(this.nomdelaville)">
      <div *ngIf="bonplanDeleted" class="alert alert-success" style="text-align: center; font-size: large; font-style: oblique;">You've successfully deleted the Bon Plan !!!</div>
      
      <div class="row">

        <div class = "col card-bp">
          <div class="gros-titre">
            <h1>Les bons plans</h1>
          </div>
          <div class="en-tete-card">
            <button *ngIf="allowModeratorRight || allowUserRight" mat-raised-button class="waves-effect waves-light btn btn-bp"
            (click)="goToFormAddBonPlan()" style="color:wheat; background-color: black;">&nbsp; Nouveau Plan
            <i class="material-icons right" style="font-size: 23px;">add_circle_outline</i>
            </button>
            <div class="choix-tri">
              <label for="DropdownOptions">Trier par:</label>
              <select class="form-control" id="DropdownOptions" (click)="Trie1()" >
                <option
                  *ngFor="let opt of ngOptions"
                  [selected]="opt === ngDropdown"
                  [value]="opt" >{{ opt }}
                </option>
              </select>
            </div>
          </div>

          <div *ngFor="let bp of allBonPlan">
            <div class="card" testBorderCard = 'setHeight=50'> <!--(click)="deleteBonPlan(nomdelaville, nomdelactivite)"-->
              <div class="card-content-bp">
                <div class="left-content">
                  <h2>{{ bp.name }}</h2>
                  <div class="row-avis-date">
                    <p *ngIf="bp.note.length == 0 ">(pas encore d'avis)</p>
                    <div class="notation" *ngIf="!(bp.note.length == 0)"> {{moyenneTableau(bp.note)}}
                      <div *ngIf="moyenneTableau(bp.note) < '2.3'" class="notation">
                        <i class="material-icons notation_étoile" style="font-size: 20px; color: red">
                          star
                        </i> <i> ({{bp.note.length}} avis) </i>
                      </div>
                      <div *ngIf="moyenneTableau(bp.note) > '3.7'" class="notation">
                        <i class="material-icons notation_étoile" style="font-size: 20px; color: green">
                          star
                        </i> <i> ({{bp.note.length}} avis) </i>
                      </div>
                      <div *ngIf="moyenneTableau(bp.note) >= '2.3' && moyenneTableau(bp.note) <= '3.7' " class="notation">
                        <i class="material-icons notation_étoile" style="font-size: 20px; color: orange">
                          star
                        </i> <i> ({{bp.note.length}} avis) </i>
                      </div>
                    </div>

                    <div class="separator">
                    </div>
                    <div class="date-bp">
                      <p>il y a {{getDateCreaBp(bp.date)[0]}} {{getDateCreaBp(bp.date)[1]}}</p>
                    </div>
                  </div>
                  

                    <hr style="margin-top: 3%; margin-bottom: 3%;">
                    <p>{{ bp.address }}</p>
                    <hr style="margin-top: 3%; margin-bottom: 3%;">
                    <div *ngIf="bp.already_noted == 'false'" class="rating">Laissez-nous votre avis ! &#160;
                      <div>
                         <a id="étoile5" (click)="noteClick('5', bp.note, bp.name, bp.address, bp.note_user)" title="Donner 5 étoiles">☆</a><!--
                      --><a id="étoile4" (click)="noteClick('4', bp.note, bp.name, bp.address, bp.note_user)" title="Donner 4 étoiles">☆</a><!--
                      --><a id="étoile3" (click)="noteClick('3', bp.note, bp.name, bp.address, bp.note_user)" title="Donner 3 étoiles">☆</a><!--
                      --><a id="étoile2" (click)="noteClick('2', bp.note, bp.name, bp.address, bp.note_user)" title="Donner 2 étoiles">☆</a><!--
                      --><a id="étoile1" (click)="noteClick('1', bp.note, bp.name, bp.address, bp.note_user)" title="Donner 1 étoile">☆</a>
                      </div>
                    </div>
                    <div *ngIf = "bp.already_noted == 'true'" >
                      <p class="information_call_note"> <i class="material-icons">check</i> La communauté BonPlan vous remercie pour cet avis !!</p>
                    </div>
                  </div>
                  <img class = "img-test" src="{{currentImg}}">
                  <!-- Enlever allowUserRight quand on aura plusieurs utilisateurs (le modérateur peut tout faire et le user peut modifier
                  ses bp )-->
                  <i *ngIf="(allowModeratorRight || currentUser == bp.user_name)" id='trashBtn' class='fa fa-trash' (click)="deleteBonPlan(bp.name)"></i> 
                  <i *ngIf="(allowModeratorRight || currentUser == bp.user_name)" id='editBtn' class="gg-edit-markup" aria-hidden="false" (click)="updateBonPlan(bp)"></i>
                </div>     
            </div> 
          </div>
        </div>

        <div class = "col card-mp">
          <div class="gros-titre">
            <h1>Les mauvais plans</h1>
          </div>
          <div class="en-tete-card">
            <!-- <button *ngIf="allowModeratorRight || allowUserRight" mat-raised-button class="waves-effect waves-light btn btn-bp"
            (click)="goToFormAddBonPlan()" style="color:wheat; background-color: black;">&nbsp; Nouveau Plan
            <i class="material-icons right" style="font-size: 23px;">add_circle_outline</i>
            </button> -->
            <div class="choix-tri">
              <label for="DropdownOptions">Trier par:</label>
              <select class="form-control" id="DropdownOptions2" (click)="Trie2()" >
                <option
                  *ngFor="let opt of ngOptions2"
                  [selected]="opt === ngDropdown2"
                  [value]="opt" >{{ opt }}
                </option>
              </select>
            </div>
          </div>
          <div *ngFor="let bp of allMauvaisPlan">
            <div class="card"> <!--(click)="deleteBonPlan(nomdelaville, nomdelactivite)"-->
                <div class="card-content-mp">
                  <div class="left-content">
                    <h2>{{ bp.name }}</h2>
                    <div class="row-avis-date">

                      <p *ngIf="bp.note.length == 0 ">(pas encore d'avis)</p>
                      <div class="notation" *ngIf="!(bp.note.length == 0)"> {{moyenneTableau(bp.note)}}
                        <div *ngIf="moyenneTableau(bp.note) < '2.3'" class="notation">
                          <i class="material-icons notation_étoile" style="font-size: 20px; color: red">
                            star
                          </i> <i> ({{bp.note.length}} avis) </i>
                        </div>
                        <div *ngIf="moyenneTableau(bp.note) > '3.7'" class="notation">
                          <i class="material-icons notation_étoile" style="font-size: 20px; color: green">
                            star
                          </i> <i> ({{bp.note.length}} avis) </i>
                        </div>
                        <div *ngIf="moyenneTableau(bp.note) >= '2.3' && moyenneTableau(bp.note) <= '3.7' " class="notation">
                          <i class="material-icons notation_étoile" style="font-size: 20px; color: orange">
                            star
                          </i> <i> ({{bp.note.length}} avis) </i>
                        </div>
                        <div class="separator">
                        </div>
                        <div class="date-bp">
                          <p>il y a {{getDateCreaBp(bp.date)[0]}} {{getDateCreaBp(bp.date)[1]}}</p>
                        </div>
                    </div>
                    
                    </div>
                    <hr style="margin-top: 3%; margin-bottom: 3%;">
                    <p>{{ bp.address }}</p>
                    <hr style="margin-top: 3%; margin-bottom: 3%;">
                    <p>Commentaires {{ bp.commentaries }} de javainuse </p>
                    <hr style="margin-top: 3%; margin-bottom: 3%;">
                    <div *ngIf="bp.already_noted == 'false'" class="rating">Laissez-nous votre avis ! &#160;
                      <div>
                         <a id="étoile5" (click)="noteClick('5', bp.note, bp.name, bp.address, bp.note_user)" title="Donner 5 étoiles">☆</a><!--
                      --><a id="étoile4" (click)="noteClick('4', bp.note, bp.name, bp.address, bp.note_user)" title="Donner 4 étoiles">☆</a><!--
                      --><a id="étoile3" (click)="noteClick('3', bp.note, bp.name, bp.address, bp.note_user)" title="Donner 3 étoiles">☆</a><!--
                      --><a id="étoile2" (click)="noteClick('2', bp.note, bp.name, bp.address, bp.note_user)" title="Donner 2 étoiles">☆</a><!--
                      --><a id="étoile1" (click)="noteClick('1', bp.note, bp.name, bp.address, bp.note_user)" title="Donner 1 étoile">☆</a>
                      </div>
                    </div>
                    <div *ngIf = "bp.already_noted == 'true'" >
                      <p class="information_call_note"> <i class="material-icons">check</i> La communauté BonPlan vous remercie pour cet avis !!</p>
                    </div>
                    <!-- <div *ngIf="bp.already_noted == 'false' ">
                      Bon Plan déjà noté
                    </div> -->
                  </div>
                  <img class = "img-test" src="{{currentImg}}">
                  <!-- Enlever allowUserRight quand on aura plusieurs utilisateurs (le modérateur peut tout faire et le user peut modifier
                  ses bp )-->
                  <i *ngIf="(allowModeratorRight || currentUser == bp.user_name)" id='trashBtn' class='fa fa-trash' (click)="deleteBonPlan(bp.name)"></i> 
                  <i *ngIf="(allowModeratorRight || currentUser == bp.user_name)" id='editBtn' class="gg-edit-markup" aria-hidden="false" (click)="updateBonPlan(bp)"></i>
                </div>     
            </div> 
          </div>
        </div>
      </div>
    </div>
    <div class="center" style="display:flex; flex-direction: column; align-items: center;"
    *ngIf="!this.listNameVille.includes(this.nomdelaville) || !this.listNameActivities.includes(this.nomdelactivite)">
    <img src="../assets/img/travolta.gif">
    <h1 style="margin: 20px"> Cette ville ou cette activité n'existe pas !</h1>
    <button id = "AjoutAct" mat-raised-button class="waves-effect waves-light btn " routerLink="/ville" 
    style="color:wheat; background-color: black; margin-bottom: 20px;
    display: flex; align-content: center; flex-direction: row-reverse;"
    >Retour à la page d'accueil
      <i class="material-icons right" style="font-size: 23px;">subdirectory_arrow_left</i>
    </button>
  </div>
    </body>
  </html>
 